name: read

on:
  workflow_dispatch:
  schedule:
    - cron: '0 */6 * * *'
  # watch:
  #   types: [started]

jobs:
  auto-update:
    runs-on: ubuntu-latest

    steps:
      # Checkout repository to access source code
      - name: Checkout
        uses: actions/checkout@v3

      # Install .NET 10 SDK for C# script execution
      - name: Setup .NET
        uses: actions/setup-dotnet@v3
        with:
          dotnet-version: '10.0.x'

      # Execute read-only operations against Microsoft Graph API
      # This mode performs non-destructive read operations
      # - Does NOT create, modify, or delete any resources
      - name: Execute Read Operations
        shell: bash
        env:
          # JSON configuration containing multiple Microsoft accounts
           # Format: [{"ClientId":"...", "ClientSecret":"...", "RefreshToken":"..."}]
          ACCOUNTS_JSON: ${{ secrets.ACCOUNTS_JSON }} 
        run: |
          cd src
          dotnet run Program.cs read
